
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>IIO DRIVERS</title>
  <meta name="author" content="Georgiana Chelu">

  
  <meta name="description" content="I&rsquo;m really excited to talk about my first important conference attendance. This year, the Open Source Summit conference took place in &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
   <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="IIO DRIVERS" type="application/atom+xml">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Lato:400,100,100italic,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro:200,300,400,500,600,700,900' rel='stylesheet' type='text/css'>




  

  <style>html{background: url(/images/back7.jpg) no-repeat center center fixed;-webkit-background-size: cover;-moz-background-size: cover;-o-background-size: cover;background-size: cover;}</style>
</head>

<body   >
  <header role="banner"><hgroup>
</hgroup>

</header>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2018/11/16/open-source-summit/">Open Source Summit Europe 2018</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2018-11-16T19:33:19+02:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><br></p>

<p><p>
I&rsquo;m really excited to talk about my first important conference attendance. This year, the Open Source Summit conference took place in Edinburgh on 22-24th of October.</p>

<p><img class="center" src="/images/oss.jpg" title="image" alt="images">
<br>
<p>
The conference was a great place to meet amazing people and to share ideas.</p>

<p><img class="center" src="/images/conference.jpg" title="image" alt="images">
<br>
<p>
I had the opportunity to be part of the &ldquo;Panel Discussion: Outreachy Linux Kernel Internship Report&rdquo;, moderated by Julia Lawall, the coordinator of the program. My presentation was about my work at the ADS1118 sensor. At the end of the talk, there was an open discussion about how to encourage women to contribute to open source projects.</p>

<p><img class="center" src="/images/talk.jpeg" title="image" alt="images">
<br>
<p>
One of my favourite presentations was the one given by Greg Kroah-Hartman, a Linux kernel maintainer and an amazing speaker. He talked about Meltdown and Specter, two of the most critical security vulnerabilities and their impact to Linux kernel.</p>

<p>Steven Rostedt, a remarkable Linux kernel contributor and developer at VMWare, gave an outstanding talk about Dynamic Kernel Tracing Events.</p>

<p><img class="center" src="/images/greg-talk.jpg" title="image" alt="images"></p>

<p><img class="center" src="/images/greg-talk-2.jpg" title="image" alt="images">
<br>
<p></p>

<p>Edinburgh is an amazing and historical city. There are a lot of famous places like Edinburgh Castle, Old Town, Princes Street. We visited Edinburgh Castle in the evening. And the view on top of the castle took our breath away.</p>

<p><img class="center" src="/images/street.jpg" title="image" alt="images"></p>

<p><br>
<p>
I encourage you to apply to the Outreachy program. You can find more information about the current round at this <a href='https://kernelnewbies.org/OutreachyIntro'>link</a>. There are a lot of interesting projects!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2018/02/02/hello-ads1015/">Hello, ADS1015!</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2018-02-02T01:13:07+02:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Tux and his Gibson</h2>

<p><img class="right" src="/images/tux-guitar.jpg" title="image" alt="images"></p>

<p>His main hobby is playing guitar, especially electric guitar which makes the sound of the guitar to be heard from the Earth to the Moon. Tux told me that the first guitar which performed analog-to-digital conversion was a Gibson guitar in 2002.</p>

<p><p>
<a href='https://ro.pinterest.com/pin/270356783857623037/'>Link to the Tux image</a></p>

<p><br> <br> <br> <br>
An analog-to-digital converter takes an analog signal as input and outputs a digital signal. See the below image to fully understand the difference between these two types of signals.
<img class="center" src="/images/analog-to-digial-signal.jpg" title="image" alt="images"></p>

<p><a href='http://pediaa.com/difference-between-analog-and-digital-signals/'>Link to the Analog to Digital Signal</a></p>

<h2>ADS1015 sensor</h2>

<p>In the past weeks our goal was to develop a driver for an ADC sensor, the ADS1118. By looking through the existing ADC drivers in the Linux Kernel source we found out that there is a converter with similar characteristics and that converter is ADS1015.</p>

<p>The main difference between ADS1118 and ADS1015 is the serial communication interface. The first one is on SPI (serial peripheral interface) and the second one is on I2C interface.</p>

<p>The challenge was to split the code for ADS1118 into a core file and an I2C file and to add the SPI file. As you may guess, the core file contains the common functions used to read from channels and to convert the signal into digital values. The SPI and I2C files, are used for the communication between the sensor and the adaptor or microcontroller.</p>

<h2>Compile and configure the Linux Kernel for Raspberry Pi</h2>

<p>For checking if the I2C communication is still working after the split, I used a Raspberry Pi. If you have a Raspberry Pi and want to a connect a sensor from linux/drivers/iio, follow these steps:</p>

<p><p>
Download the from the official site.
<br>
<code>wget https://downloads.raspberrypi.org/raspbian_latest</code>
<p>
Write the Raspbian image to the SD card using <a href='https://etcher.io/'>Etcher</a>.
<p>
Download the kernel source for Raspberry.
<br>
<code>git clone --depth=1 https://github.com/raspberrypi/linux</code>
<p>
Make the default configuration.
<br>
<code>make bcm2709_defconfig</code>
<p>
Compile the kernel.
<br>
<code>make -j4 zImage modules dtbs</code>
<p>
Install the modules.
<br>
<code>sudo make modules_install</code>
<p>
Copy the files to /boot.
<br>
<code>sudo cp arch/arm/boot/dts/*.dtb /boot/</code>
<code>sudo cp arch/arm/boot/dts/overlays/*.dtb* /boot/overlays/</code>
<code>sudo cp arch/arm/boot/zImage /boot/kernel7.img</code>
<p>
Reboot the Raspberry</p>

<p><p></p>

<h2>Connect the pins</h2>

<p>Before connecting the sensor, be sure that you have the right tools. Install the i2c-tools and check the pins.
<br>
<code>sudo apt-get install i2c-tools</code>
<br>
<code>sudo i2cdetect -y 1</code></p>

<p><p>
Make the following connections from ADS1015 to your Raspberry Pi:
<br>
*   VDD to 3v3 Power (pin 1)
<br>
*   SDA to Data (pin 3)
<br>
*   SCL to Clock (pin 5)
<br>
*   GND to Ground (pin 6)</p>

<p>The Raspberry&rsquo;s pins and ADS1015&rsquo;s pins can be found in the below images.</p>

<p><img class="center" src="/images/ads1015.png" title="image" alt="images">
<img class="center" src="/images/raspberryspins.png" title="image" alt="images"></p>

<p><a href='http://int03.co.uk/blog/2014/12/17/analogue-input-board-for-the-pressure-sensor-espiresso/'>Link to ADS1015</a>
<br>
<a href='https://pinout.xyz/pinout/i2c#'>Link to Raspberry&rsquo;s Pins</a></p>

<h2>Measure the voltage</h2>

<p>Now that we have the wire connections, create a new IIO device with the command:</p>

<p><code>echo ads1015 0x48 &gt; /sys/bus/i2c/devices/i2c-1/new_device</code></p>

<p>After the sensor initialization, we can start measuring the voltage.</p>

<p>For example, connect a wire from the Raspberry’s Pin 1 to the ADS1015’s A0 pin and check the /sys/bus/iio/devices/iio:device0/in_voltage0_raw file.</p>

<p><code>cat /sys/bus/iio/devices/iio:device0/in_voltage0_raw</code></p>

<p>Another example is to connect a wire from Raspberry&rsquo;s Pin 6 to the ADS1015&rsquo;s A0 pin and check the same file. You will find that the voltage is 0 because A0 is wired to ground.</p>

<h2>Results</h2>

<p><p>
We managed to check the two examples after splitting the ADS1015 into the 2 files: core, i2c.
<p>
The next challenge is to check if the ADS1118 implementation is working. This ADC sensor has a SPI interface. See you soon!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2018/01/07/start-the-adeventure-the-setup-part/">Start the Adeventure: The Setup Part</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2018-01-07T12:22:26+02:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Intro</h2>

<p><img class="right" src="/images/yoda-tux.jpg" title="image" alt="images"></p>

<p>Our wise friend, will introduce us the world of Linux Kernel. Check below the piece of wisdom from Yoda Tux.</p>

<p>Good coding vibe needs a good working environment. So, our setup, let’s see how to do.  There are several simple steps and, take them one by one, will we.  Hihihi!</p>

<p><a href='https://ro.pinterest.com/pin/270356783857623037/'>Link to the Yoda Tux image</a></p>

<p><br></p>

<h2>The source code</h2>

<p>Download the kernel source tree of Industrial I/O:</p>

<p><code>git clone https://www.kernel.org/pub/scm/linux/kernel/git/jic23/iio.git</code></p>

<h2>The default config</h2>

<p>The next step is to configure the kernel. As a good practice, use the default configuration and later add or remove kernel modules. To create the configuration file, run the following command:</p>

<p><code>make defconfig</code></p>

<p>The configuration is based on the architecture type of the host system (eg: x86, powerpc, sparc64). The available architectures are to the iio/arch path.</p>

<h2>Customize the kernel config</h2>

<p>As the I/O subsystem is not part of the default configuration, we have to add the module using the command:</p>

<p><code>make menuconfig</code></p>

<p>This command opens the menu from the image, which is not friendly, but easy to use. Navigate with the arrows keys, press Y to include a module, press N to exclude a module and M to create a module from that feature/driver.</p>

<p><img class="center" src="/images/menuconfig.png" title="image" alt="images"></p>

<p>To search for any feature or module, just press the <strong>/</strong> (the slash key from the keyboard) and type the name.</p>

<p><img class="center" src="/images/search-bar.png" title="image" alt="images"></p>

<p>At this moment, we are looking for the Industrial I/O Subsystem. Let’s type IIO and press Enter. The result looks like the below image.</p>

<p><img class="center" src="/images/iio-result.png" title="image" alt="images"></p>

<p>Each results from the list has a corresponding number between <strong>parentheses</strong>. Go to the feature by pressing the indicated number.</p>

<p>In this situation, the Industrial I/O subsystem has the number <strong>(1)</strong>, but it depends on other 3 features:
<em>RTC_DRV_HID_SENSOR_TIME</em>
<em>RTC_CLASS</em>
<em>USB_HID</em></p>

<p>The first one is marked with <strong>[=n]</strong>, which means that it is not selected to be part of the kernel configuration. Adding this features includes automatically the Industrial I/O module in the kernel. So, let’s search for the <em>RTC_DRV_HID_SENSOR_TIME</em> and include it.  Further, search again for the IIO. Check if the feature is marked with <strong>[=y]</strong>.</p>

<p>Save the new kernel configuration by pressing the <strong>save</strong> button. Keep the default name of the configuration file which is <strong>.config</strong>. You can check the existence of this file in the <strong>iio</strong> folder (the root folder of the source code).</p>

<h2>Compile the source code</h2>

<p>The next step is to compile the kernel. It is recommended command to use all the processing units in order to finish the compiling fast. In the next command, the <strong>nproc</strong> gives the maximum number of the processor units available on your hardware. So, take a break, have some coffee or tea and come back later.</p>

<p><code>make -j `nproc`</code></p>

<p>In case you still want to use the computer during the processing time, replace the <strong>nproc</strong> with a number lower than the maximum units.</p>

<p>In case a feature was marked as module in the menuconfig, the module (a file with he <strong>.ko</strong> extension) will be available when the compiling is finished.</p>

<h2>The kernek image</h2>

<p>After the compiling is done, the kernel image could be found on the path:</p>

<p><code>iio/arch/your_architecture/boot/bzImage</code></p>

<p>In my case, the path is <strong>iio/arch/x86_64/boot/bzImage</strong> because the kernel was compiled for a 64bit Intel architecture.</p>

<h2>Qemu setup</h2>

<p>The Qemu is an easy and fast tool to create a virtual machine. Follow the tutorial to build a qemu with a custom kernel (<a href='https://mudongliang.github.io/2017/09/12/how-to-build-a-custom-linux-kernel-for-qemu.html'>link</a>) and use the kernel image that you have just compiled.</p>

<p>My piece of advice is to run the qemu as in the tutorial, with</p>

<p><code>-nographic -append "console=ttyS0"</code></p>

<p>These two parameters let the qemu to run without opening a new windows and to show the output in the working terminal.</p>

<h2>Possible issue:</h2>

<p>The qemu is on 32bit, but the kernel is compiled on 64bit. Check in the menu config if the first option matches the type of the qemu architecture.
<img class="center" src="/images/arch-type.png" title="image" alt="images"></p>

<h2>Time to work</h2>

<p>In case you encounter a problem with the tutorial, send me an email to</p>

<p>&lt;georgiana.chelu93 AT SPAMFREE gmail DOT com></p>

<p>and as Yoda Tux would say:</p>

<blockquote>
Patience you must have, my young padawan.
</blockquote>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/12/05/hello-from-the-tux-side/">Hello From the Tux Side</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2017-12-05T01:12:19+02:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Hello!</p>

<p>I am Georgiana and I am currently pursuing a Master&rsquo;s Degree in Advanced Network Security at the University Politehnica of Bucharest. In addition to this, I am glad to say that I was accepted to the Outreachy Round 15. The project that I was selected for aims to build an Industrial I/O Driver.</p>

<p>This journey started 3 years ago when I applied to Outreachy for the first time. Back then, my lack of experience did not stop me to give it a try. The result was not the one I was expected and my confidence faded. Thus, the following years, my main focus was on building a solid knowledge in the C programming language, Git and Linux Kernel. Now, I am happy that I will write my first driver for the IIO Linux Kernel module, under the guidance of Daniel Băluță and Alison Schofield. I own them lot of thanks for their time and their support.</p>

<p>The community played an important role by helping me during the application period. The mentors had an incredible patience for our silly mistakes and their responses revealed professionalism, passion and attention to details. Regarding my contribution to Linux Kernel, my struggle in the past was the Git tool. But this time, I discovered the beauty of using this version control system. Now, I am ready to level up my knowledge and confidence.</p>

<p><img class="right" src="/images/wizard-tux.jpg" title="image" alt="images"></p>

<p>So, let the adventure of IIO Drivers begin! Tux will join me in this journey and help me during the future challenges. He will help me through debugging sessions (as rubber duck) or will make things happen (as a wizard would do).</p>

<p><a href='http://supermaitre.eklablog.fr/'>Wizard Tux image source.</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/11/18/non-outreachy-post/">Non-outreachy Post</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2017-11-18T19:33:19+02:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Hello from the other side!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/11/18/hello-tux/">Hello, Tux!</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2017-11-18T19:11:42+02:00" pubdate data-updated="true"></time>
        
      </p>
    
  </header>


  <div class="entry-content">
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives/"> Archives </a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section id="titles">
  <a href="" title="IIO DRIVERS"><img id="logo" src="/images/tux-mona.png" /></a> 
  <h1 id="site_title"><a href="" title="IIO DRIVERS">IIO DRIVERS</a></h1>
  <h3 id="site_subtitle">A blog about Tux and drivers</h3>
</section>

<section id="menu">
  <ul>
    <li><i class="fa fa-home fa-lg"></i><a href=""> Home </a></li>
    <li><i class="fa fa-calendar fa-lg"></i><a href="/blog/archives/"> Archives </a></li>
    <li><i class="fa fa-user fa-lg"></i><a href="/about/"> About </a></li>
    <li><i class="fa fa-rss fa-lg"></i><a href="/blog/categories/outreachy/atom.xml"> Outreachy Feed </a></li>
  </ul>
</section>

<section id="social">
  

  

  
    <a href="" title="g+#GeorgianaChelu"><i class="fa fa-google-plus fa-2x"></i></a>
  

  

  

  
    <a href="https://twitter.com/giach10" title="giach10"><i class="fa fa-twitter fa-2x"></i></a>
  
</section>


<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2018/11/16/open-source-summit/">Open Source Summit Europe 2018</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/02/02/hello-ads1015/">Hello, ADS1015!</a>
      </li>
    
      <li class="post">
        <a href="/blog/2018/01/07/start-the-adeventure-the-setup-part/">Start the adeventure: The Setup Part</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/12/05/hello-from-the-tux-side/">Hello from the Tux side</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/11/18/non-outreachy-post/">Non-outreachy post</a>
      </li>
    
  </ul>
</section>



<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/GeorgianaChelu?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2018 - Georgiana Chelu -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
